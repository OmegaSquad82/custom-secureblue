---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: kinoite-main-hardened-customized
description: My personal flavor of secureblue for portable devices
base-image: ghcr.io/secureblue/kinoite-main-hardened
image-version: latest

modules:
  # is imported by the workflow!
  # - type: secureblue-signing
  #   source: local

  - type: files
    files:
      - source: system
        destination: /

  - type: dnf
    repos:
      copr:
        - name: atim/starship
          chroot: fedora-42-x86_64
        - name: emixampp/synology-drive
          chroot: fedora-42-x86_64
      files:
        - https://download.opensuse.org/repositories/network:im:signal/Fedora_%OS_VERSION%/network:im:signal.repo
    group-install:
      with-optional: true
      packages:
        - java
    group-remove:
      packages:
        - firefox
    install:
      packages:
        - clatd
        - htop
        - hw-probe
        - https://github.com/rmcrackan/Libation/releases/download/v12.5.4/Libation.12.5.4-linux-chardonnay-amd64.rpm
        - neovim
        - signal-desktop
        - starship
        - synology-drive
    remove:
      packages:
        - firefox-langpacks
        - tailscale

  - type: fonts
    fonts:
      nerd-fonts:
        - Hack
        - Terminus

  - type: systemd
    system:
      enabled:
        - clatd.service
        - zram-compaction.timer
        - zram-recompression.timer

  - type: kargs
    arch: x86_64
    kargs:
      - rootflags=subvol=root,compress-force=zstd:3,discard=async,lazytime,noatime,space_cache=v2,x-systemd.device-timeout=0

  - type: signing
